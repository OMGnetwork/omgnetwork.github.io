<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Blockchain Design · OMG Network</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="This page describes the blockchain (consensus) design used by the first iteration of OMG Network Plasma-based implementation. This design is a modified version of [Minimal Viable Plasma design](https://ethresear.ch/t/minimal-viable-plasma/426)."/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Blockchain Design · OMG Network"/><meta property="og:type" content="website"/><meta property="og:url" content="https://omgnetwork.github.io/"/><meta property="og:description" content="This page describes the blockchain (consensus) design used by the first iteration of OMG Network Plasma-based implementation. This design is a modified version of [Minimal Viable Plasma design](https://ethresear.ch/t/minimal-viable-plasma/426)."/><meta property="og:image" content="https://omgnetwork.github.io/img/logo/omg-blue.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://omgnetwork.github.io/img/logo/omg-blue.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-154130721-1"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments); }
              gtag('js', new Date());
              gtag('config', 'UA-154130721-1');
            </script><link rel="stylesheet" href="/css/code-block-buttons.css"/><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"/><script type="text/javascript" src="js/typeform.js"></script><script type="text/javascript" src="js/g-tag.js"></script><script type="text/javascript" src="js/h-jar.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script type="text/javascript" src="js/intercom.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo/omg-white.svg" alt="OMG Network"/></a><a href="/versions"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/next/welcome" target="_self">Docs</a></li><li class="siteNavGroupActive"><a href="/next/api" target="_self">APIs</a></li><li class="siteNavGroupActive"><a href="/next/environments" target="_self">Environments</a></li><li class=""><a href="https://omg.network" target="_blank">Product</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Concepts</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/next/welcome">About the OMG Network</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Network</h3><ul class=""><li class="navListItem"><a class="navItem" href="/next/network/start">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/next/network/balances">Retrieve Balances</a></li><li class="navListItem"><a class="navItem" href="/next/network/deposits">Deposit Funds</a></li><li class="navListItem"><a class="navItem" href="/next/network/transfers">Make a Transfer</a></li><li class="navListItem"><a class="navItem" href="/next/network/standard-exits">Start a Standard Exit</a></li><li class="navListItem"><a class="navItem" href="/next/network/in-flight-exits">Start an In-flight Exit</a></li><li class="navListItem"><a class="navItem" href="/next/network/process-exits">Process an Exit</a></li><li class="navListItem"><a class="navItem" href="/next/network/utxos">Merge or Split UTXO</a></li><li class="navListItem"><a class="navItem" href="/next/network/challenge-exits">Challenge an Exit</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Use Cases</h3><ul class=""><li class="navListItem"><a class="navItem" href="/next/use-cases/community-points">Community Points Engine</a></li><li class="navListItem"><a class="navItem" href="/next/use-cases/exchange">Exchange</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Wallet</h3><ul class=""><li class="navListItem"><a class="navItem" href="/next/wallet/quick-start-webwallet">Web Wallet Quick Start</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Contracts</h3><ul class=""><li class="navListItem"><a class="navItem" href="/next/contracts/plasma-proposition">Plasma Proposition</a></li><li class="navListItem"><a class="navItem" href="/next/contracts/admin-accounts">Administrative Accounts</a></li><li class="navListItem"><a class="navItem" href="/next/contracts/morevp">MoreVP Technical Overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Watcher</h3><ul class=""><li class="navListItem"><a class="navItem" href="/next/watcher/run-watcher">Run a Watcher</a></li><li class="navListItem"><a class="navItem" href="/next/watcher/manage-vps">Manage a VPS</a></li><li class="navListItem"><a class="navItem" href="/next/watcher/manage-watcher">Manage a Watcher</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Security</h3><ul class=""><li class="navListItem"><a class="navItem" href="/next/security/bug-bounty">Bug Bounty Program</a></li><li class="navListItem"><a class="navItem" href="/next/security/audits">Contracts Audits</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">3-rd Party</h3><ul class=""><li class="navListItem"><a class="navItem" href="/next/3rd-party/metamask">MetaMask</a></li><li class="navListItem"><a class="navItem" href="/next/3rd-party/multibaas">MultiBaas</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Concepts</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/next/network/blockchain-design">Blockchain Design</a></li><li class="navListItem"><a class="navItem" href="/next/network/byzantine-conditions">Byzantine Conditions</a></li><li class="navListItem"><a class="navItem" href="/next/network/network-architecture">Network Architecture</a></li><li class="navListItem"><a class="navItem" href="/next/network/challenge-period">Challenge Period</a></li><li class="navListItem"><a class="navItem" href="/next/network/exitbonds">Exit Bonds</a></li><li class="navListItem"><a class="navItem" href="/next/network/fees">Fees</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Resources</h3><ul class=""><li class="navListItem"><a class="navItem" href="/next/glossary">Glossary</a></li><li class="navListItem"><a class="navItem" href="/next/faq">FAQ</a></li><li class="navListItem"><a class="navItem" href="/next/api">API References</a></li><li class="navListItem"><a class="navItem" href="/next/environments">Environments</a></li><li class="navListItem"><a class="navItem" href="/next/release-notes">Release Notes</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Migration Guides</h3><ul class=""><li class="navListItem"><a class="navItem" href="/next/migration-0.2-0.3">0.2 to 0.3</a></li><li class="navListItem"><a class="navItem" href="/next/migration-0.3-0.4">0.3 to 0.4</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Blockchain Design</h1></header><article><div><span><p>This page describes the blockchain (consensus) design used by the first iteration of OMG Network Plasma-based implementation. This design is a modified version of <a href="https://ethresear.ch/t/minimal-viable-plasma/426">Minimal Viable Plasma design</a>.</p>
<blockquote>
<p>This content assumes that you have prior knowledge of Ethereum and general familiarity with Plasma.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="tesuji-plasma-architecture"></a><a href="#tesuji-plasma-architecture" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tesuji Plasma architecture</h3>
<p>Tesuji Plasma's architecture allows cheaper transactions and higher throughput, without sacrificing security. Users make transactions on a child chain that derives its security from a root chain.</p>
<p>Child chain refers to a blockchain that coalesces multiple transactions into a child chain block, compacting them into a single, cheap transaction on a root chain. OMG Network's root chain is the Ethereum blockchain.</p>
<h3><a class="anchor" aria-hidden="true" id="omg-networks-blockchain-design"></a><a href="#omg-networks-blockchain-design" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>OMG Network's blockchain design</h3>
<p>The key features of OMG Network's blockchain design may be viewed as deviations from the big picture Plasma that is outlined by the original Plasma paper:</p>
<ol>
<li><p>Only supports transactions transferring value between addresses.</p>
<p>Value transfer can take the form of an atomic swap; that is two currencies being exchanged in a single transaction (multiple currencies: Eth + ERC20).</p></li>
<li><p>It is a non-p2p, proof-of-authority network.</p>
<p>The child chain is centrally controlled by a designated, fixed Ethereum address (the child chain operator); other participants (that is, users) connect to the child chain server.</p></li>
<li><p>Employs a single-tiered Plasma construction. That is, the child chain doesn't serve as a parent of any chain.</p></li>
<li><p>Does not allow cheap, coordinated mass exits.</p></li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="security-and-scalability"></a><a href="#security-and-scalability" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Security and scalability</h3>
<p>Security and scalability are built into the design, with the following features:</p>
<ol>
<li>Deposit funds into a contract on the root chain.</li>
<li>Make inexpensive, multiple transfers of funds deposited on the child chain.</li>
<li>Exit any funds held on the child chain, and securely reclaim them on the root chain.</li>
<li>Every exit of funds held on the child chain must come with proof that the exit is justified. The following sections clarify the nature of such proof (an attestation or evidence justifying the exit).</li>
</ol>
<h4><a class="anchor" aria-hidden="true" id="proving-a-justified-exit"></a><a href="#proving-a-justified-exit" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Proving a justified exit</h4>
<p>Exits are allowed regardless of the state of the PoA child chain. Thus, funds held on the child chain and on the root chain may be treated as equivalent. Thus, if anything goes wrong on the child chain, everyone must exit to the root chain.</p>
<p>Plasma architecture presumes root chain availability.</p>
<h3><a class="anchor" aria-hidden="true" id="components-driving-consensus"></a><a href="#components-driving-consensus" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Components driving consensus</h3>
<p>The following components drive consensus:</p>
<ul>
<li>Root chain contract</li>
<li>Child chain server</li>
<li>Watcher</li>
</ul>
<p>Each component is discussed in this article.</p>
<h2><a class="anchor" aria-hidden="true" id="root-chain-contract"></a><a href="#root-chain-contract" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Root chain contract</h2>
<p>The root chain contract secures the child chain. This includes the following:</p>
<ul>
<li>Holds funds deposited by other addresses.</li>
<li>Tracks child chain block hashes that include information about funds deposit to the child chain.</li>
<li>Manages secure exiting of funds, including exits of in-flight transactions.</li>
</ul>
<p>The child chain, and the root chain contract that secures it, manage funds using the UTXO model.</p>
<h3><a class="anchor" aria-hidden="true" id="deposits"></a><a href="#deposits" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deposits</h3>
<p>Any Ethereum address may deposit ETH or ERC20 tokens into the root chain contract. Deposits increase the pool of funds held by the root chain contract and also signals to the child chain server that the funds should be accessible on the child chain.</p>
<p>Deposited funds are recognized as a single UTXO on the child chain. The UTXO can then be spent on the child chain (provided that the child chain server follows consensus), or it can be exited immediately on the root chain (regardless of whether the child chain server follows consensus).</p>
<p>Depositing involves forming a pseudo-block of the child chain. The pseudo block contains a single transaction with the deposited funds as a new UTXO.</p>
<h3><a class="anchor" aria-hidden="true" id="exits-w-exit-challenges"></a><a href="#exits-w-exit-challenges" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exits w/ exit challenges</h3>
<p>Exits are the most important part of the root chain contract. Exits provide the equivalence of funds sitting in the child chain vs funds on the root chain.</p>
<p>Exits must satisfy the following conditions:</p>
<table>
<thead>
<tr><th>Condition</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>E1</td><td>Only funds represented by UTXOs that were provably included in the child chain may be exited. This means that only funds that provably existed may be exited.</td></tr>
<tr><td>E2</td><td>Attempts to exit funds that have been provably spent on the child chain, must be thwarted and punished.</td></tr>
<tr><td>E3</td><td>If the attacking child chain operator submits a block with dishonest UTXOs attempting to exit them, the priority is given to earlier UTXOs. This allows all UTXOs created before the dishonest UTXOs to exit first.</td></tr>
<tr><td>E4</td><td>In-flight funds (funds locked up in a transaction) that might be included in the child chain, must be able to exit funds with known inclusion.</td></tr>
</tbody>
</table>
<h4><a class="anchor" aria-hidden="true" id="submitting-exit-requests-and-challenging"></a><a href="#submitting-exit-requests-and-challenging" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Submitting exit requests and challenging</h4>
<p>The following mechanisms satisfy conditions E1 and E2, depending on the inclusion:</p>
<ul>
<li>Regular exit</li>
<li>In-flight exit</li>
</ul>
<h5><a class="anchor" aria-hidden="true" id="regular-exit"></a><a href="#regular-exit" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Regular exit</h5>
<p>May be used by UTXOs containing the transaction with details about the creation of these UTXOs.</p>
<p>Any Ethereum address that can prove possession of funds (UTXO) on the child chain can submit a request to exit.</p>
<p>The proof involves showing the transaction that contains the UTXO as output, and proving that the transaction is included in one of the submitted child chain blocks.</p>
<p>However, additional attestation is required to allow the withdrawal of funds from the root chain contract. The submitted exit request must still withstand a challenge period allowing anyone to provide evidence that the exited UTXO has been spent.</p>
<p>The evidence consists of a signed transaction, showing the spending of the exiting UTXO, regardless of its inclusion.</p>
<p>An exit challenge period counts from the exit request submission until this exit's scheduled finalization time.</p>
<p>A successful and timely exit challenge invalidates the exit.</p>
<h5><a class="anchor" aria-hidden="true" id="in-flight-exit"></a><a href="#in-flight-exit" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>In-flight exit</h5>
<p>May be used by in-flight funds where the inclusion of the transaction manipulating such funds is not known or they're included in an invalid chain.</p>
<p>Assuming that the in-flight transaction has inputs that had been outputs of a transaction included in a valid chain, such funds can be recovered using the MoreVP protocol.</p>
<h4><a class="anchor" aria-hidden="true" id="finalizing-exits-at-scheduled-finalization-time-sft"></a><a href="#finalizing-exits-at-scheduled-finalization-time-sft" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Finalizing exits at Scheduled Finalization Time (SFT)</h4>
<p>Finalizing an exit means releasing funds from the root chain contract to the exitor. Exits finalize at their Scheduled finalization time (SFT).</p>
<p>Exit scheduling and priorities satisfy condition E3.</p>
<p>The table describes scheduled finalization time (SFT) for different types of exits:</p>
<table>
<thead>
<tr><th>Exit type</th><th>Scheduled finalization time (SFT)</th></tr>
</thead>
<tbody>
<tr><td>Regular exits</td><td><code>SFT = max(exit_request_block.timestamp + MFP, utxo_submission_block.timestamp + MFP + REP)</code></td></tr>
<tr><td>In-flight exits</td><td><code>exitable_at = max(exit_request_block.timestamp + MFP, youngest_input_block.timestamp + MFP + REP)</code></td></tr>
<tr><td>Deposits</td><td>The exit priority for deposits is elevated to protect against malicious operators: <code>SFT = max(exit_request_block.timestamp + MFP, utxo_submission_block.timestamp + MFP)</code></td></tr>
</tbody>
</table>
<p>See <a href="/contracts/morevp">MoreVP Technical Overview</a> for further details.</p>
<hr>
<h5><a class="anchor" aria-hidden="true" id="configuration-parameters-for-scheduled-finalization-time-sft"></a><a href="#configuration-parameters-for-scheduled-finalization-time-sft" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration parameters for Scheduled Finalization Time (SFT)</h5>
<p>The table describes the configuration parameters for Scheduled Finalization Time (SFT):</p>
<table>
<thead>
<tr><th>Parameter</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>exit_request_block</td><td>The root chain block where the exit request is mined.</td></tr>
<tr><td>utxo_submission_block</td><td>The root chain block where the exiting UTXO was created in a child chain block.</td></tr>
<tr><td>youngest_input_block</td><td>The root chain block where the youngest input of the exiting transaction was created.</td></tr>
</tbody>
</table>
<h5><a class="anchor" aria-hidden="true" id="exit-waiting-period"></a><a href="#exit-waiting-period" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exit waiting period</h5>
<p>All exits must wait at least the Minimum Finalization Period (MFP) to ensure the required challenge period process.</p>
<p>Freshly exited UTXOs must wait an additional Required Exit Period (REP), counting from their submission to the root chain contract.</p>
<p>Example values for these exit waiting periods, as in Minimal Viable Plasma:</p>
<ul>
<li>MFP - 1 week</li>
<li>REP - 1 week</li>
</ul>
<h5><a class="anchor" aria-hidden="true" id="exit-priority"></a><a href="#exit-priority" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exit priority</h5>
<p>Root chain contract allows finalizing exits after their Scheduled Finalization Time (SFT) had passed. In this case, exits are processed in ascending order of exit priority:</p>
<p>Exit priority has two keys:</p>
<ul>
<li>Primary key: The SFT (Scheduled Finalization Time)</li>
<li>Secondary key: The UTXO position</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="child-chain-validation-frequency"></a><a href="#child-chain-validation-frequency" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Child chain validation frequency</h4>
<p>There are maximum periods of time a user can spend offline without validating a particular aspect of the chain exposing themselves to the risk of fund loss.</p>
<p>User must validate with the following frequency:</p>
<ul>
<li>Validate the child chain every <code>REP</code> to ensure you have enough time to submit an exit request in case the chain is invalid.</li>
<li>Validate exits every <code>MFP</code> to challenge invalid regular exits.</li>
<li>Validate in-flight exits every <code>MFP/2</code> to challenge invalid actions in the in-flight exit protocol.</li>
</ul>
<blockquote>
<p>To cover all possible misbehaviors that may occur in the network, user must validate at rarest every <code>min(REP, MFP/2)</code>.</p>
</blockquote>
<h4><a class="anchor" aria-hidden="true" id="example-exit-scenario"></a><a href="#example-exit-scenario" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example exit scenario</h4>
<p>Scenario:  MFP = 1 day, REP = 2 day.</p>
<p>The table illustrates the relation between MFP and REP in the scenario:</p>
<ul>
<li><p>Day 1: Operator creates, includes, and starts to exit an invalid UTXO.</p></li>
<li><p>Day 3: User has been offline for two days.</p>
<p>User checks chain (REP) and sees the invalid transaction.</p>
<p>The user exits his old UTXO.</p></li>
<li><p>Day 4: Both operator and user can exit (after MFP) but the user's exit takes precedence based on utxoPos.</p></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="block-submissions"></a><a href="#block-submissions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Block submissions</h3>
<p>Only a designated address that belongs to the child chain operator may submit blocks.</p>
<p>Every block submitted to the root chain contract compacts multiple child chain transactions. Effectively, the block being submitted means that during exiting, ownership of funds (inclusion of transaction) can be now proven using a new child chain block hash.</p>
<h3><a class="anchor" aria-hidden="true" id="network-congestion"></a><a href="#network-congestion" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Network congestion</h3>
<p>The child chain allows a maximum of N UTXOs at a given time on the child chain.</p>
<p>N is bound by the root chain's bandwidth limitations and is the maximum amount of UTXOs that can safely request to exit if the child chain becomes invalid.</p>
<p>Plasma assumes the root chain network and gas availability to start all users' exits in time. If network congestion occurs, time is frozen on the root chain contract until it becomes safe to operate again.</p>
<blockquote>
<p>Important! The full implementation of this feature is reserved for future research and development.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="reorgs"></a><a href="#reorgs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reorgs</h3>
<p>Reorg refers to changing the order of blocks and transactions on the root chain. Reorgs can lead to spurious invalidity of the child chain. For instance, without any protection, a deposit can be placed and then spent quickly on the child chain.</p>
<p>Everything is valid if the submit block root chain transaction gets mined after the deposit (causing the honest child chain to allow the spend). However, if the order of these transactions gets reversed due to a reorg, the spend will appear before the deposit, rendering the child chain invalid.</p>
<p>OMG Network blockchain employs these mechanisms to protect itself against reorgs:</p>
<ul>
<li><p>Only allow deposits to be used on the child chain N Ethereum Block confirmations.</p>
<p>This allows you to make it expensive for miners who want to try invalidating the child chain.
The rule is built into the child chain. The root chain contract won't enforce this in any way.</p></li>
<li><p>Account nonce mechanism protects the submission of blocks to the root chain contract.</p>
<p>Miners attempting to mine blocks in the wrong order will produce an incorrect Ethereum block.</p></li>
<li><p>Child chain blocks are numbered independently from the numbering of deposit blocks.</p>
<p>A deposit block that disappears won't invalidate the numbering of the child chain blocks.</p></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="child-chain-server"></a><a href="#child-chain-server" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Child chain server</h2>
<p>The child chain server creates and submits blocks. This includes the following:</p>
<ul>
<li>Collects valid transactions that move funds on the child chain.</li>
<li>Submits child chain block hashes to the root chain contract.</li>
<li>Publishes contents of child chain blocks.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="collecting-transactions"></a><a href="#collecting-transactions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Collecting transactions</h3>
<p>The child chain server collects transactions and immediately executes valid transactions.</p>
<p>The child chain has a transaction per block limit. It represents a maximum number of transactions that can go in a single child chain block.</p>
<p>A submitted transaction that exceeds the limit is queued and scheduled for inclusion in the next block. The queue is prioritized by transaction fee value. When there are too many transactions in the queue, transactions with the lowest fees are lost and must be resubmitted.</p>
<blockquote>
<p>Transaction per block limit is assumed to be 2^16, per Minimal Viable Plasma.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="submitting-and-propagating-blocks"></a><a href="#submitting-and-propagating-blocks" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Submitting and propagating blocks</h3>
<p>The child chain server submits blocks to the root chain contract.</p>
<p>Every T amount of time, the child chain submits a block (in the form of blocks' transactions Merkle root hash) to the root chain contract, and shares the block's content with the Watcher. Watcher receives the block and extracts the required information.</p>
<p>If the child chain operator withholds a submitted block or if it submits an invalid block hiding the block contents, then everyone must exit.</p>
<h3><a class="anchor" aria-hidden="true" id="transactions"></a><a href="#transactions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transactions</h3>
<p>A transaction involves spending existing UTXO(s) (inputs), and creating new UTXO(s) (outputs).</p>
<p>A transaction typically specifies the following:</p>
<ul>
<li>Input sent</li>
<li>Output owner</li>
<li>Sender's amount (owner of the input)</li>
<li>Recipient's amount (owner of the output)</li>
</ul>
<p>A transaction must include the spender's signature, which is proof the sender consents to their funds being spent.</p>
<p>Each transaction can have up to 4 UTXOs as inputs, and it can create up to 4 UTXOs as outputs.</p>
<p>The child chain operator is eligible to claim a transaction fee (the surplus of the amount being input over the amount being output) using the following model:</p>
<p><code>(sumAmount(spent UTXOs) - sumAmount(created UTXOs) &gt;= 0)</code> ⁠— the fee that the child chain operator is eligible to claim later.</p>
<p>As a result, the child chain will have the following:</p>
<pre><code class="hljs">[
  [sig1, sig2, sig3, sig4],
  [inpPos1, inpPos2, inpPos3, inpPos4],
  [
    [newOwner1, currency1, amount1],
    [newOwner2, currency2, amount2],
    [newOwner3, currency3, amount3],
    [newOwner4, currency4, amount4]
  ],
  metadata
]
</code></pre>
<ul>
<li><p><strong>inpPos</strong></p>
<p>Defines input to the transaction. Every <code>inpPos</code> is an output's unique position, derived from:</p>
<ul>
<li>Child block number</li>
<li>Transaction index within the block</li>
<li>Output index</li>
</ul>
<p>The transaction is valid only when every output for the transaction is unspent.</p>
<p>Value may be zero when less than 4 inputs are required.</p></li>
<li><p><strong>sig</strong></p>
<p>Signature of all other fields in a transaction; RLP-encoded, and hashed.</p>
<p>A transaction must have a non-zero signature per every non-zero input used, under the same indices. Any zero input must have a zero signature (65 zero bytes) delivered.</p></li>
<li><p><strong>newOwner, currency, and amount</strong></p>
<p>A single output, specifying the address of the new owner, for a specified amount of currency.</p></li>
<li><p><strong>metadata</strong></p>
<p>Optional. The maximum data limit is 32bytes. Requires zero logic, and is included only in the transaction hashes preimage.</p>
<p>To exclude this field, simply skip it in the array.</p></li>
</ul>
<blockquote>
<p>All zero outputs, inputs must come after the non-zero ones.</p>
</blockquote>
<blockquote>
<p>To create a valid transaction you must have access to the positions of all the UTXOs that you own.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> *Detailed documentation for the transaction encoding scheme used is pending. In the meantime, please refer to the implementation details in the  <code>elixir-omg</code> GitHub repo: <a href="https://github.com/omgnetwork/elixir-omg/blob/master/apps/omg/lib/omg/state/transaction/signed.ex#L35">here</a> and <a href="https://github.com/omgnetwork/elixir-omg/blob/master/apps/omg/lib/omg/state/transaction/signed.ex#L41">here</a>.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="watcher"></a><a href="#watcher" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Watcher</h2>
<p>The Watcher validates the child chain, ensuring the child chain consensus mechanism is working properly. It also performs the following operations:</p>
<ul>
<li>Tracks the root chain contract, published blocks and transactions.</li>
<li>Reports any breach of consensus.</li>
<li>As an additional service, collects and stores the account information required to use the child chain.</li>
<li>As an additional service, it provides a convenience API to access the child chain API and Ethereum.</li>
<li>Protects user by restricting access only to those times the child chain is valid.</li>
</ul>
<p>All cryptographic primitives used (signatures, hashes) are understood to be ones compatible with whatever EVM uses. The Watcher is assumed to be run by the users. Users on the child chain must be able to trust the Watcher.</p>
<p>The proper functioning of the Watcher is critical to keeping deposited funds secure.</p>
<p>The Watcher performs these tasks:</p>
<ul>
<li>Pings the child chain server to ensure everything is valid.</li>
<li>Monitors the root chain contract for a lockSubmitted event log (a submission of a child chain block).</li>
<li>Pings the child chain for the full block, when it receives a log.</li>
<li>Verifies the validity of the block, and checks that its root matches the child chain root that was submitted.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="invalid-chain-and-funds-exit"></a><a href="#invalid-chain-and-funds-exit" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Invalid chain and funds exit</h3>
<p>The Watcher checks for the following conditions, which will optionally prompt for an exit challenge:</p>
<ul>
<li>Exits during their challenge period referencing UTXOs that have already been spent on the child chain.</li>
<li>Invalid actions taken during the in-flight exit game. Check <a href="/contracts/morevp">MoreVP Technical Overview</a> for more details.</li>
</ul>
<p>As soon as one Watcher detects an invalid child chain, all Watchers trigger a notification to anyone with assets on the child chain to exit immediately.</p>
<p>The Watcher also monitors for any of the following conditions, which signals an invalid chain and causes the Watcher to prompt for an exit of funds:</p>
<ol>
<li>Invalid blocks.</li>
</ol>
<p>The following may signal invalid blocks:</p>
<ul>
<li>Transactions spending an input spent in any prior block.</li>
<li>Transactions spending exited inputs, if unchallenged or challenge failed or was too late.</li>
<li>Transactions with deposits that haven't happened.</li>
<li>Transactions with invalid inputs.</li>
<li>Transactions with invalid signatures.</li>
</ul>
<ol start="2">
<li>The operator exits more fees than they're due.</li>
</ol>
<p>The Watcher must ensure that the operator never exits more fees than they're due because funds covering exited fees come from the same pool as deposited funds. So if the child chain operator exits too much in fees, there may not be enough funds left in the root chain contract for the exit.</p>
<ol start="3">
<li>Unable to validate a submitted child chain block.</li>
</ol>
<p>The Watcher needs information to validate a child chain block that's been submitted to the root chain. If it can't acquire the information or it takes too long to get this information, this will trigger a funds exit prompt.</p>
<ol start="4">
<li>Invalid claim on root chain contract left unchallenged for too long risks security on fund on child chain.</li>
</ol>
<p>Any invalid claim is done on the root chain contract (e.g. an invalid exit) that goes without challenge for too long and becomes a risk to the security of the funds held on the child chain.</p>
<h3><a class="anchor" aria-hidden="true" id="watcher-storage-facilities"></a><a href="#watcher-storage-facilities" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Watcher storage facilities</h3>
<p>The storage facilities of the Watcher are also known as <em>account information</em>.</p>
<p>Watcher takes on an additional responsibility: collecting and storing data relevant to secure handling of user's assets on the child chain, such as:</p>
<ol>
<li>UTXOs in possession of the address holding assets.</li>
<li>Full transaction history (child chain blocks).</li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="exchange"></a><a href="#exchange" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exchange</h2>
<p>For a high-level discussion about exchange designs on top of Tesuji plasma, see <a href="https://github.com/omgnetwork/elixir-omg/blob/master/docs/dex_design.md">OMG Network Decentralized Exchange</a> (ODEX).</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/next/3rd-party/multibaas"><span class="arrow-prev">← </span><span class="function-name-prevnext">MultiBaas</span></a><a class="docs-next button" href="/next/network/byzantine-conditions"><span>Byzantine Conditions</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#root-chain-contract">Root chain contract</a><ul class="toc-headings"><li><a href="#deposits">Deposits</a></li><li><a href="#exits-w-exit-challenges">Exits w/ exit challenges</a></li><li><a href="#block-submissions">Block submissions</a></li><li><a href="#network-congestion">Network congestion</a></li><li><a href="#reorgs">Reorgs</a></li></ul></li><li><a href="#child-chain-server">Child chain server</a><ul class="toc-headings"><li><a href="#collecting-transactions">Collecting transactions</a></li><li><a href="#submitting-and-propagating-blocks">Submitting and propagating blocks</a></li><li><a href="#transactions">Transactions</a></li></ul></li><li><a href="#watcher">Watcher</a><ul class="toc-headings"><li><a href="#invalid-chain-and-funds-exit">Invalid chain and funds exit</a></li><li><a href="#watcher-storage-facilities">Watcher storage facilities</a></li></ul></li><li><a href="#exchange">Exchange</a></li></ul></nav></div><div class="footer-content"><div class="footer-wrapper"><div class="footer-column"><span class="footer-title">Getting Started</span><span class="footer-item"><a href="/contracts/morevp">MoreVP Architecture</a></span><span class="footer-item"><a href="/wallet/quick-start-webwallet">Web Wallet Quick Start</a></span><span class="footer-item"><a href="https://github.com/omgnetwork/web-wallet">Web Wallet Code</a></span><span class="footer-item"><a href="https://github.com/omgnetwork/omg-js-samples">omg-js samples</a></span></div><div class="footer-column"><span class="footer-title">API References</span><span class="footer-item"><a href="https://docs.omg.network/elixir-omg/docs-ui/?urls.primaryName=master%2Finfo_api_specs">Watcher
Informational API</a></span><span class="footer-item"><a href="https://docs.omg.network/elixir-omg/docs-ui/?urls.primaryName=master%2Fsecurity_critical_api_specs">Watcher
Security Critical API</a></span><span class="footer-item"><a href="https://docs.omg.network/elixir-omg/docs-ui/">Child Chain API</a></span></div><div class="footer-column"><span class="footer-title">Integration Docs</span><span class="footer-item"><a href="https://github.com/omgnetwork/elixir-omg/blob/master/README.md">Elixir-omg</a></span><span class="footer-item"><a href="https://github.com/omgnetwork/omg-js/blob/master/README.md">Omg-js</a></span><span class="footer-item"><a href="/network/start">Tutorials</a></span><span class="footer-item"><a href="https://github.com/omgnetwork/plasma-contracts">Plasma Contracts</a></span></div><div class="footer-column"><span class="footer-title">Resources</span><span class="footer-item"><a href="https://omg.eco/blockexplorer">Block Explorer</a></span><span class="footer-item"><a href="https://www.omg.network">OMG Network</a></span><span class="footer-item"><a href="https://github.com/omgnetwork">Github</a></span></div><div class="footer-column"><span class="footer-title">Follow us</span><span class="footer-item"><a href="https://twitter.com/omgnetworkhq"><img src="/img/social/twitter.svg" alt="twitter" class="footer-social"/></a><a href="https://www.linkedin.com/company/omgnetwork/"><img src="/img/social/linkedin.svg" alt="linkedin" class="footer-social"/></a><a href="https://github.com/omgnetwork"><img src="/img/social/github.svg" alt="github" class="footer-social"/></a><br/> <br/><span class="footer-copyright">© 2019-present OMG Network.
All rights reserved</span></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'af8e7b1e7bcb8af0f31e1c3aca2f8d16',
                indexName: 'omisego',
                inputSelector: '#search_input_react'
              });
            </script></body></html>